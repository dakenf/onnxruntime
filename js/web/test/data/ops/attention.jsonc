[
  {
    "name": "Attention Basic",
    "operator": "Attention",
    "opset": { "domain": "com.microsoft", "version": 1 },
    "attributes": [{ "name": "num_heads", "data": 1, "type": "int" }],
    "cases": [
      {
        "name": "T[0]",
        "inputs": [
          {
            "data": [1, 2, 3, 4, 5, 6, 7, 8],
            "dims": [1, 2, 4],
            "type": "float32"
          },
          {
            "data": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
            "dims": [4, 3],
            "type": "float32"
          },
          {
            "data": [1, 2, 3],
            "dims": [3],
            "type": "float32"
          }
        ],
        "outputs": [
          {
            "data": [213, 213],
            "dims": [1, 2, 1],
            "type": "float32"
          }
        ]
      }
    ]
  },
  {
    "name": "Attention Basic Batch 2 with 2 heads",
    "operator": "Attention",
    "opset": { "domain": "com.microsoft", "version": 1 },
    "attributes": [{ "name": "num_heads", "data": 2, "type": "int" }],
    "cases": [
      {
        "name": "T[0]",
        "inputs": [
          {
            "data": [
              1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,
              16
            ], // Q for batch size of 2 with 2 heads
            "dims": [2, 2, 8], // [BatchSize, NumHeads, SeqLen*HeadDim]
            "type": "float32"
          },
          {
            "data": [
              1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4,
              4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4
            ], // K for batch size of 2 with 2 heads
            "dims": [8, 6], // [BatchSize, NumHeads, SeqLen*HeadDim]
            "type": "float32"
          },
          {
            "data": [1, 2, 3, 4, 5, 6], // V for batch size of 2 with 2 heads
            "dims": [6], // [BatchSize, NumHeads, SeqLen*HeadDim]
            "type": "float32"
          }
        ],
        "outputs": [
          {
            "data": [320, 321, 320, 321, 320, 321, 320, 321], // Placeholder for output data
            "dims": [2, 2, 2], // [BatchSize, NumHeads, SeqLen*HeadDim]
            "type": "float32"
          }
        ]
      }
    ]
  },
  {
    "name": "Attention Basic",
    "operator": "Attention",
    "opset": { "domain": "com.microsoft", "version": 1 },
    "attributes": [{ "name": "num_heads", "data": 1, "type": "int" }],
    "cases": [
      {
        "name": "T[0]",
        "inputs": [
          {
            "data": [0.3367, 0.1288, 0.2345, 0.2303, -1.1229, -0.1863],
            "dims": [1, 3, 2],
            "type": "float32"
          },
          {
            "data": [2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094],
            "dims": [2, 3],
            "type": "float32"
          },
          {
            "data": [1.1103, -1.6898, -0.989],
            "dims": [3],
            "type": "float32"
          }
        ],
        "outputs": [
          {
            "data": [-1.328187108039856, -1.297916054725647, -0.8599594831466675],
            "dims": [1, 3, 1],
            "type": "float32"
          }
        ]
      }
    ]
  },
  {
    "name": "Attention Basic one head, batch 2",
    "operator": "Attention",
    "opset": { "domain": "com.microsoft", "version": 1 },
    "attributes": [{ "name": "num_heads", "data": 1, "type": "int" }],
    "cases": [
      {
        "name": "T[0]",
        "inputs": [
          {
            "data": [0.3367, 0.1288, 0.2345, 0.2303, -1.1229, -0.1863, 2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094],
            "dims": [2, 3, 2],
            "type": "float32"
          },
          {
            "data": [2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094],
            "dims": [2, 3],
            "type": "float32"
          },
          {
            "data": [1.1103, -1.6898, -0.989],
            "dims": [3],
            "type": "float32"
          }
        ],
        "outputs": [
          {
            "data": [
              -1.328187108039856, -1.297916054725647, -0.8599594831466675, -0.1792980432510376, -0.26380985975265503,
              -0.25473490357398987
            ],
            "dims": [2, 3, 1],
            "type": "float32"
          }
        ]
      }
    ]
  },
  {
    "name": "Attention Basic 2 head, batch 1",
    "operator": "Attention",
    "opset": { "domain": "com.microsoft", "version": 1 },
    "attributes": [{ "name": "num_heads", "data": 2, "type": "int" }],
    "cases": [
      {
        "name": "T[0]",
        "inputs": [
          {
            "data": [0.3367, 0.1288, 0.2345, 0.2303, -1.1229, -0.1863, 2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094],
            "dims": [2, 3, 2],
            "type": "float32"
          },
          {
            "data": [2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094, 0.2345, 0.2303, 0.4617, 1.44, -2.22, 3.6643],
            "dims": [2, 6],
            "type": "float32"
          },
          {
            "data": [1.1103, -1.6898, -0.989, -0.989, 1.1103, -1.6898],
            "dims": [6],
            "type": "float32"
          }
        ],
        "outputs": [
          {
            "data": [
              0.8701779842376709, -2.6158859729766846, 0.8710794448852539, -2.5763747692108154, 0.9005484580993652,
              -2.182751178741455, 2.1661579608917236, -2.1045265197753906, 1.6716957092285156, -1.797281265258789,
              1.7134947776794434, -1.765358328819275
            ],
            "dims": [2, 3, 2],
            "type": "float32"
          }
        ]
      }
    ]
  },
  {
    "name": "Attention Basic 5 head, batch 1",
    "operator": "Attention",
    "opset": { "domain": "com.microsoft", "version": 1 },
    "attributes": [{ "name": "num_heads", "data": 5, "type": "int" }],
    "cases": [
      {
        "name": "T[0]",
        "inputs": [
          {
            "data": [
              0.3367, 0.1288, 0.2345, 0.2303, -1.1229, -0.1863, 2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094,
              0.8701779842376709, 0.9005484580993652, -1.9029953479766846, 0.8710794448852539, -1.9054111242294312,
              -1.8803634643554688, 2.1661579608917236, 1.7134947776794434, -1.5250005722045898, 1.6716957092285156,
              -1.0069535970687866, -1.486573576927185, -1.328187108039856, -1.297916054725647, -0.8599594831466675,
              -0.1792980432510376, -0.26380985975265503, -0.25473490357398987
            ],
            "dims": [2, 3, 5],
            "type": "float32"
          },
          {
            "data": [
              2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094, 0.2345, 0.2303, 0.4617, 1.44, -2.22, 3.6643,
              0.8710794448852539, -1.9054111242294312, 0.9005484580993652, 0.8701779842376709, 0.9005484580993652,
              -1.9029953479766846, 0.8710794448852539, -1.9054111242294312, -1.8803634643554688, 2.1661579608917236,
              1.7134947776794434, -1.5250005722045898, 1.6716957092285156, -1.0069535970687866, -1.486573576927185,
              -1.328187108039856, -1.297916054725647, -0.8599594831466675, -0.1792980432510376, -0.26380985975265503,
              -0.25473490357398987, 2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094, 0.2345, 0.2303, 0.4617, 1.44, -2.22,
              3.6643, 0.8710794448852539, -1.9054111242294312, 0.9005484580993652, 0.8701779842376709,
              0.9005484580993652, -1.9029953479766846, 0.8710794448852539, -1.9054111242294312, -1.8803634643554688,
              2.1661579608917236, 1.7134947776794434, -1.5250005722045898, 1.6716957092285156, -1.0069535970687866,
              -1.486573576927185, -1.328187108039856, -1.297916054725647, -0.8599594831466675, -0.1792980432510376,
              -0.26380985975265503, -0.25473490357398987, 2.2082, 0.8710794448852539, -1.9054111242294312,
              0.9005484580993652, 1.9029953479766846, 0.8710794448852539, -1.9054111242294312, -1.8803634643554688,
              2.1661579608917236
            ],
            "dims": [5, 15],
            "type": "float32"
          },
          {
            "data": [
              1.1103, -1.328187108039856, -1.297916054725647, -0.8599594831466675, -0.1792980432510376,
              -0.26380985975265503, -0.25473490357398987, -1.6898, -0.989, -1.9029953479766846, 0.8710794448852539,
              -1.9054111242294312, -1.8803634643554688, 2.1661579608917236, 1.7134947776794434
            ],
            "dims": [15],
            "type": "float32"
          }
        ],
        "outputs": [
          {
            "data": [
              -1.6956915855407715, -2.8863370418548584, 1.3899128437042236, 1.6789076328277588, -1.4083852767944336,
              -1.7009180784225464, -3.1053788661956787, 3.5959298610687256, 1.1027096509933472, -0.009643087163567543,
              -1.694351315498352, -2.9284396171569824, 1.734721302986145, 2.0606398582458496, -0.2571452260017395,
              3.671973943710327, -5.285338401794434, -6.833454132080078, 1.7506506443023682, -2.262148380279541,
              2.5110034942626953, 1.440049171447754, -0.9423203468322754, 1.7506506443023682, -1.86212158203125,
              -0.5036701560020447, -5.732386589050293, -1.5674757957458496, 1.7506510019302368, -2.264472246170044
            ],
            "dims": [2, 3, 5],
            "type": "float32"
          }
        ]
      }
    ]
  },
  {
    "name": "Attention Basic 5 head, batch 1",
    "operator": "Attention",
    "opset": { "domain": "com.microsoft", "version": 1 },
    "attributes": [{ "name": "num_heads", "data": 5, "type": "int" }],
    "cases": [
      {
        "name": "T[0]",
        "inputs": [
          {
            "data": [
              0.3367, 0.1288, 0.2345, 0.2303, -1.1229, -0.1863, 2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094,
              0.8701779842376709, 0.9005484580993652, -1.9029953479766846, 0.8710794448852539, -1.9054111242294312,
              -1.8803634643554688, 2.1661579608917236, 1.7134947776794434, -1.5250005722045898, 1.6716957092285156,
              -1.0069535970687866, -1.486573576927185, -1.328187108039856, -1.297916054725647, -0.8599594831466675,
              -0.1792980432510376, -0.26380985975265503, -0.25473490357398987
            ],
            "dims": [2, 3, 5],
            "type": "float32"
          },
          {
            "data": [
              2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094, 0.2345, 0.2303, 0.4617, 1.44, -2.22, 3.6643,
              0.8710794448852539, -1.9054111242294312, 0.9005484580993652, 0.8701779842376709, 0.9005484580993652,
              -1.9029953479766846, 0.8710794448852539, -1.9054111242294312, -1.8803634643554688, 2.1661579608917236,
              1.7134947776794434, -1.5250005722045898, 1.6716957092285156, -1.0069535970687866, -1.486573576927185,
              -1.328187108039856, -1.297916054725647, -0.8599594831466675, -0.1792980432510376, -0.26380985975265503,
              -0.25473490357398987, 2.2082, -0.638, 0.4617, 0.2674, 0.5349, 0.8094, 0.2345, 0.2303, 0.4617, 1.44, -2.22,
              3.6643, 0.8710794448852539, -1.9054111242294312, 0.9005484580993652, 0.8701779842376709,
              0.9005484580993652, -1.9029953479766846, 0.8710794448852539, -1.9054111242294312, -1.8803634643554688,
              2.1661579608917236, 1.7134947776794434, -1.5250005722045898, 1.6716957092285156, -1.0069535970687866,
              -1.486573576927185, -1.328187108039856, -1.297916054725647, -0.8599594831466675, -0.1792980432510376,
              -0.26380985975265503, -0.25473490357398987, 2.2082, 0.8710794448852539, -1.9054111242294312,
              0.9005484580993652, 1.9029953479766846, 0.8710794448852539, -1.9054111242294312, -1.8803634643554688,
              2.1661579608917236
            ],
            "dims": [5, 15],
            "type": "float32"
          },
          {
            "data": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
            "dims": [15],
            "type": "float32"
          }
        ],
        "outputs": [
          {
            "data": [
              -1.5670859813690186, -3.7310283184051514, -2.7460145950317383, 0.8121700286865234, -3.350031852722168,
              -1.5735238790512085, -3.7310383319854736, 6.124307632446289, 0.7840213775634766, -0.7250789403915405,
              -1.565433382987976, -3.731032371520996, -2.7436347007751465, 1.0472451448440552, -2.7828547954559326,
              3.7965505123138428, -2.3799397945404053, -3.9530906677246094, 0.5844926834106445, -2.9756431579589844,
              2.448162794113159, 4.34546422958374, 1.9380426406860352, 0.5870105624198914, -2.7368364334106445,
              -0.4769568145275116, 4.255186557769775, -3.9529950618743896, 0.6987408995628357, -2.9756433963775635
            ],
            "dims": [2, 3, 5],
            "type": "float32"
          }
        ]
      }
    ]
  }
]
